{%- assign resume = site.data.resume -%}
<!-- All code adapted from https://github.com/chadbaldwin/chadbaldwin.github.io/blob/main/_includes/resume.html -->
<script>
  // Set a more informative document title for printing or PDF saving
  document.title = "{{ resume.header.name }}{% if resume.header.suffix %}, {{ resume.header.suffix }}{% endif %} - {{ resume.header.current_title }} - Resume";

  function JobDateDiff(start, end) {
      var daysDiff = (new Date(end).getTime() - new Date(start).getTime()) / 86400000; // ms in a day
      var years = Math.floor(daysDiff / 365.25);
      var months = Math.ceil(daysDiff % 365.25 / 30.4375);
      if (months == 12) { months = 0; years++; }

      var returnText = "";
      if (years === 1) { returnText += `${years} yr `; }
      if (years > 1) { returnText += `${years} yrs `; }
      if (months === 1) { returnText += `${months} mo `; }
      if (months > 1) { returnText += `${months} mos `; }
      returnText = returnText.trim();

      document.write(returnText);
  }

  // Close the bottom bar on click
  document.addEventListener("click", function(e) {
    if (e.target.classList.contains("bottom-bar__close")) {
      document.querySelector(".bottom-bar").remove();
    }
  });
</script>

<link href="https://fonts.googleapis.com/css?family=Lora:400,700|Open+Sans:400,300,800,700" rel="stylesheet" type="text/css">
<link href="/css/resume.css" rel="stylesheet" type="text/css">

<!-- Metadata -->
{%- if resume.contact.phone -%}
<meta itemprop="telephone" content="{{ resume.contact.phone }}"/>
{%- endif -%}
{%- if resume.contact.address -%}
<meta itemprop="address" content="{{ resume.contact.address }}"/>
{%- endif -%}

<header class="page-header">
  <!-- Avatar -->
  {%- if site.gravatar_hash -%}
    <img src="https://www.gravatar.com/avatar/{{ site.gravatar_hash }}?size=100" alt="my photo" class="avatar no-print" itemprop="image">
  {%- endif -%}

  <!-- Name and Suffix -->
  <div class="header-title">
    <span class="header-name" itemprop="name">{{ resume.header.name }}</span>
    {%- if resume.header.suffix -%}
      <span class="header-suffix">, {{ resume.header.suffix }}</span>
    {%- endif -%}
  </div>

  <!-- Contact Info -->
  {%- if resume.header.display_contact_info -%}
    <div class="header-contact-info">
      {%- for item in resume.contact -%}
        <span class="header-contact-info-item">{{ item[1] }}</span>
        {%- unless forloop.last -%}
          <span> &bull; </span>
        {%- endunless -%}
      {%- endfor -%}
    </div>
  {%- endif -%}

  <!-- Title and Social Links -->
  <div class="title-bar no-print">
    <div class="job-title" itemprop="jobTitle">{{ resume.header.current_title }}</div>
    {%- if resume.social -%}
      <div class="icon-links">
        {%- for item in resume.social -%}
          <a href="{{ item[1] }}" class="icon-link" itemprop="sameAs" target="_blank">
            <i class="fab fa-{{ item[0] | downcase }}"></i>
          </a>
        {%- endfor -%}
      </div>
    {%- endif -%}
  </div>
</header>

<!-- Content Sections -->
<main>
  {%- for section in resume.sections -%}
    <section id="{{ section.id }}" class="resume-section">
      <h2 class="section-title">{{ section.title }}</h2>
      {%- if section.description -%}
        <div class="section-description">
          {{ section.description | markdownify }}
        </div>
      {%- endif -%}
      
      {%- if section.items -%}
        <ul class="section-list">
          {%- for item in section.items -%}
            <li class="section-item">
              <h3 class="item-title">{{ item.title }}</h3>
              {%- if item.subtitle -%}
                <p class="item-subtitle">{{ item.subtitle }}</p>
              {%- endif -%}
              {%- if item.dates -%}
                <span class="item-dates">
                  {{ item.dates.start }} - {{ item.dates.end }}
                  <script>JobDateDiff('{{ item.dates.start }}', '{{ item.dates.end }}')</script>
                </span>
              {%- endif -%}
              {%- if item.description -%}
                <p class="item-description">{{ item.description | markdownify }}</p>
              {%- endif -%}
            </li>
          {%- endfor -%}
        </ul>
      {%- endif -%}
    </section>
  {%- endfor -%}
</main>
